version: "3.8"
services:
  proxysql:
    image: proxysql/proxysql
    ports:
      - "6033:6033"
      - "6032:6032"
    volumes:
      - ./proxysql.cnf:/etc/proxysql.cnf
  mysql-master:
    image: mysql:8.0
    container_name: mysql-master
    environment:
      - MYSQL_ROOT_PASSWORD=noria
      - MYSQL_DATABASE=noria
    command: --server-id=1 
    ports:
      - "3306:3306"
  readyset:
    image: readysettech/readyset
    container_name: readyset
    environment:
      - UPSTREAM_DB_URL=mysql://root:noria@mysql-master:3306/noria
      - LISTEN_ADDRESS=0.0.0.0:3307
    ports:
      - "3307:3307"
      - "6034:6034"
    depends_on:
      - mysql-master
